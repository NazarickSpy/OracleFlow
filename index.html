<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>OracleFlow | AI Chat</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
<style>
:root {
  --primary:#00ffff;
  --primary-dark:#00e5e5;
  --accent:#9d4edd;
  --dark:#1F2A37;
  --darker:#111928;
  --light:#F9FAFB;
  --gray:#9CA3AF;
  --border:rgba(255,255,255,0.1);
  --chat-user:#00AEEF;
  --chat-ai:#2A2F45;
}
*{margin:0;padding:0;box-sizing:border-box;font-family:'Poppins',sans-serif;}
body{
  height:100vh;background:linear-gradient(135deg,var(--darker),var(--dark));color:var(--light);
  display:flex;flex-direction:column;overflow:hidden;
}
#particles-js{position:fixed;top:0;left:0;width:100%;height:100%;z-index:-2;}
header{
  position:relative;
  padding:15px 0;
  text-align:center;
  border-bottom:1px solid var(--border);
  background:rgba(17,25,40,0.85);
  backdrop-filter:blur(5px);
  font-size:26px;
  font-weight:700;
  color:var(--light);
}
.header-title{
  background-image:linear-gradient(90deg,var(--primary),var(--accent));
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}
.menu-btn{
  position:absolute;
  left:20px;
  top:50%;
  transform:translateY(-50%);
  font-size:22px;
  color:var(--primary);
  cursor:pointer;
  transition:.3s;
}
.menu-btn:hover{transform:translateY(-50%) scale(1.1);}
#sidebar-overlay{position:fixed;top:0;left:0;width:100%;height:100%;
background:rgba(0,0,0,0.5);visibility:hidden;opacity:0;transition:.3s;z-index:50;}
#sidebar-content{
  position:fixed;top:0;left:0;width:280px;height:100%;
  background:rgba(17,25,40,0.95);backdrop-filter:blur(10px);border-right:1px solid var(--border);
  box-shadow:2px 0 10px rgba(0,0,0,0.5);
  transform:translateX(-100%);transition:.3s;z-index:51;display:flex;flex-direction:column;
}
#sidebar-overlay.active{visibility:visible;opacity:1;}
#sidebar-overlay.active #sidebar-content{transform:translateX(0);}
.sidebar-header{
  font-size:18px;font-weight:700;color:var(--primary);
  display:flex;flex-direction:column;gap:10px;margin-bottom:10px;
}
.sidebar-header button{
  border:none;border-radius:10px;padding:10px;margin-top:5px;
  font-weight:600;cursor:pointer;background:linear-gradient(135deg,var(--primary),var(--accent));
  color:var(--darker);transition:.3s;
}
.sidebar-header button:hover{transform:translateY(-2px);}
.chat-history{flex:1;overflow-y:auto;margin-top:10px;}
.chat-item{padding:10px 15px;cursor:pointer;color:var(--gray);transition:.2s;}
.chat-item:hover{background:rgba(255,255,255,0.05);}
.chat-item.active{background:rgba(0,255,255,0.1);color:var(--light);border-left:3px solid var(--primary);}
#welcome-screen{
  flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:20px;gap:10px;
}
.welcome-logo{font-size:70px;background:linear-gradient(135deg,var(--primary),var(--accent));
-webkit-background-clip:text;-webkit-text-fill-color:transparent;animation:pulse 2s infinite;}
@keyframes pulse{0%,100%{transform:scale(1);}50%{transform:scale(1.05);}}
.welcome-title{font-size:36px;font-weight:700;background:linear-gradient(135deg,var(--primary),var(--accent));
-webkit-background-clip:text;-webkit-text-fill-color:transparent;}
.welcome-subtitle{color:var(--gray);max-width:500px;margin-bottom:20px;font-size:15px;}
.start-btn{
  background:linear-gradient(135deg,var(--primary),var(--accent));border:none;border-radius:25px;
  padding:12px 30px;font-size:16px;font-weight:600;color:var(--darker);cursor:pointer;transition:.3s;
}
.start-btn:hover{transform:translateY(-2px);}
#chat-container{
  flex:1;overflow-y:auto;display:none;flex-direction:column;gap:15px;padding:20px;padding-bottom:100px;
}
.message{max-width:80%;padding:12px 18px;border-radius:20px;font-size:16px;line-height:1.4;}
.user{align-self:flex-end;background:var(--chat-user);color:white;border-bottom-right-radius:5px;}
.ai{align-self:flex-start;background:var(--chat-ai);color:var(--light);border-bottom-left-radius:5px;}
#input-area{
  position:fixed;bottom:0;left:0;width:100%;background:rgba(17,25,40,0.95);
  backdrop-filter:blur(10px);display:flex;align-items:center;gap:10px;
  padding:12px 20px;border-top:1px solid var(--border);z-index:10;
}
#prompt-input{
  flex:1;background:var(--dark);border:none;border-radius:20px;padding:12px 18px;
  color:var(--light);font-size:16px;resize:none;min-height:44px;max-height:120px;overflow-y:auto;
}
#prompt-input:focus{outline:none;box-shadow:0 0 0 2px rgba(0,255,255,0.3);}
#send-btn,#voice-btn,#file-btn{
  background:linear-gradient(135deg,#00d4ff,#6f42c1);
  border:none;
  border-radius:20px;
  padding:10px 15px;
  color:#0b0f1a;
  font-weight:600;
  cursor:pointer;
  box-shadow:0 0 10px rgba(0,212,255,0.4);
  transition:.3s;
}
#send-btn:hover,#voice-btn:hover,#file-btn:hover{
  transform:translateY(-2px);
  box-shadow:0 0 15px rgba(111,66,193,0.5);
  filter:brightness(1.1);
}
#file-input{display:none;}
</style>
</head>
<body>
<canvas id="particles-js"></canvas>

<div id="sidebar-overlay">
  <div id="sidebar-content">
    <div class="sidebar-header">
      <button class="new-chat-btn"><i class="fa fa-plus"></i> New Chat</button>
      <div style="margin-top:10px; padding-left:10px;"><i class="fas fa-comments"></i> Chat History</div>
    </div>
    <div class="chat-history"></div>
  </div>
</div>

<!-- Tambahan di HEADER -->
<header>
  <div class="menu-btn" id="menu-btn"><i class="fas fa-bars"></i></div>
  <span class="header-title">OracleFlow</span>
</header>

<div id="welcome-screen">
  <i class="fas fa-dove" style="
  font-size:75px;
  background:linear-gradient(135deg,#00ffff,#9d4edd);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  text-shadow:0 0 15px rgba(157,78,221,0.5);
"></i>
  <h1 class="welcome-title">OracleFlow</h1>
  <p class="welcome-subtitle">
    Fast, flexible, and endlessly evolving â€” OracleFlow AI emerges from the fusion of logic and creativity, built to redefine intelligence and empower the next era of human â€“ machine harmony.
  </p>
  <button class="start-btn">Start Chat</button>
</div>

<div id="chat-container"></div>

<div id="input-area">
  <button id="file-btn"><i class="fas fa-paperclip"></i></button>
  <input type="file" id="file-input" />
  <textarea id="prompt-input" placeholder="Type your message..."></textarea>
  <button id="voice-btn"><i class="fas fa-microphone"></i></button>
  <button id="send-btn" disabled><i class="fas fa-paper-plane"></i></button>
</div>

<script>
(function(){
  const canvas = document.getElementById('particles-js');
  const ctx = canvas.getContext('2d');
  let W, H;
  const particles = [];
  const num = 100;
  const maxDist = 140;

  function resize() {
    const ratio = window.devicePixelRatio || 1; // <--- perbaikan utama
    W = window.innerWidth;
    H = window.innerHeight;
    canvas.width = W * ratio;
    canvas.height = H * ratio;
    canvas.style.width = W + "px";
    canvas.style.height = H + "px";
    ctx.setTransform(ratio, 0, 0, ratio, 0, 0);
  }

  window.addEventListener('resize', resize);
  resize();

  for (let i = 0; i < num; i++) {
    particles.push({
      x: Math.random() * W,
      y: Math.random() * H,
      r: Math.random() * 2 + 1,
      dx: (Math.random() - 0.5) * 1.2,
      dy: (Math.random() - 0.5) * 1.2
    });
  }

  function draw() {
    ctx.clearRect(0, 0, W, H);
    for (let p of particles) {
      ctx.beginPath();
      ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
      ctx.fillStyle = "rgba(0,255,255,0.35)";
      ctx.fill();

      p.x += p.dx;
      p.y += p.dy;
      if (p.x < 0 || p.x > W) p.dx *= -1;
      if (p.y < 0 || p.y > H) p.dy *= -1;
    }

    for (let i = 0; i < num; i++) {
      for (let j = i + 1; j < num; j++) {
        const a = particles[i], b = particles[j];
        const dist = Math.hypot(a.x - b.x, a.y - b.y);
        if (dist < maxDist) {
          const opacity = 1 - dist / maxDist;
          ctx.strokeStyle = `rgba(0,255,255,${opacity * 0.25})`;
          ctx.lineWidth = 0.7; // lebih tebal sedikit
          ctx.beginPath();
          ctx.moveTo(a.x, a.y);
          ctx.lineTo(b.x, b.y);
          ctx.stroke();
        }
      }
    }

    requestAnimationFrame(draw);
  }

  draw();
})();

// chat engine
(function(){
 const API_KEY="AIzaSyA4BnoJUxOopad0gnJDyFKBRcT6yrZlxPg";
 const API_URL="https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent";
 const chat=document.getElementById("chat-container"),welcome=document.getElementById("welcome-screen"),
 input=document.getElementById("prompt-input"),send=document.getElementById("send-btn"),
 voice=document.getElementById("voice-btn"),fileBtn=document.getElementById("file-btn"),
 fileInput=document.getElementById("file-input"),sidebar=document.getElementById("sidebar-overlay"),
 newChatBtn=document.querySelector(".new-chat-btn"),hist=document.querySelector(".chat-history"),
 startBtn=document.querySelector(".start-btn");
 let all=[],cur=-1,rec,isRec=false,fileData=null;
 function save(){localStorage.setItem("oracle_chats",JSON.stringify(all));}
 function load(){const d=localStorage.getItem("oracle_chats");all=d?JSON.parse(d):[];renderHistory();}
 function renderHistory(){
  hist.innerHTML=all.length?"":"<div style='color:var(--gray);text-align:center;padding:10px;'>No chat history.</div>";
  all.forEach((c,i)=>{
   const e=document.createElement("div");
   e.className="chat-item"+(i===cur?" active":"");
   e.textContent=c.messages.find(m=>m.sender==="user")?.text.slice(0,25)||"Chat "+(i+1);
   e.onclick=()=>{cur=i;renderChat();toggleSidebar();};
   hist.appendChild(e);
  });
 }
 function addMsg(t,s){const m=document.createElement("div");m.className="message "+s;m.textContent=t;chat.appendChild(m);chat.scrollTop=chat.scrollHeight;}
 function renderChat(){if(cur===-1)return;chat.innerHTML="";all[cur].messages.forEach(m=>addMsg(m.text,m.sender));show();}
 function newChat(){cur=all.push({id:Date.now(),messages:[]})-1;show();renderHistory();}
 function show(){welcome.style.display="none";chat.style.display="flex";}
 async function sendMsg(){
  const t=input.value.trim();if(!t&&!fileData)return;
  if(cur===-1)newChat();
  let txt=t;if(fileData){txt+=`\n\n[User sent file: ${fileData.name}]`;fileData=null;}
  addMsg(txt,"user");all[cur].messages.push({text:txt,sender:"user"});save();
  input.value="";send.disabled=true;
  const wait=document.createElement("div");wait.className="message ai";wait.textContent="...";chat.appendChild(wait);
  try{
   const body={contents:[{parts:[{text:txt}]}]};
   const r=await fetch(`${API_URL}?key=${API_KEY}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(body)});
   if(!r.ok)throw new Error(r.status);
   const d=await r.json();const reply=d.candidates?.[0]?.content?.parts?.[0]?.text||"No response.";
   wait.textContent=reply;all[cur].messages.push({text:reply,sender:"ai"});save();renderHistory();
  }catch(e){wait.textContent="Error: "+e.message;}
 }
 function upd(){send.disabled=input.value.trim()==="";}
 send.onclick=sendMsg;input.oninput=upd;
 input.onkeydown=e=>{if(e.key==="Enter"&&!e.shiftKey){e.preventDefault();if(!send.disabled)sendMsg();}};
 newChatBtn.onclick=()=>{newChat();toggleSidebar();};
 startBtn.onclick=()=>{show();};
 document.getElementById("menu-btn").onclick=()=>toggleSidebar(); 
 function toggleSidebar(){sidebar.classList.toggle("active");}
 sidebar.onclick=e=>{if(e.target===sidebar)toggleSidebar();};
 fileBtn.onclick=()=>fileInput.click();
 fileInput.onchange=()=>{fileData=fileInput.files[0];if(fileData){addMsg("ðŸ“Ž "+fileData.name,"user");input.focus();}};
 if("webkitSpeechRecognition"in window){
  rec=new webkitSpeechRecognition();rec.lang="en-US";
  rec.continuous=false;rec.interimResults=false;
  rec.onresult=e=>{input.value+=(input.value?" ":"")+e.results[0][0].transcript;upd();};
  rec.onerror=()=>{isRec=false;voice.style.background="var(--primary)";};
 }
 voice.onclick=()=>{
  if(!rec)return alert("Voice input not supported in this browser");
  if(isRec){rec.stop();isRec=false;voice.style.background="var(--primary)";}
  else{rec.start();isRec=true;voice.style.background="#f87171";}
 };
 load();upd();
})();
</script>
</body>
</html>
